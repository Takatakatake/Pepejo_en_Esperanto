<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>絶対配置でルビを押し下げず重ねる</title>
  <style>
    /* ベースフォントサイズ */
    .text-S_S_S { font-size: 12px; }
    .text-M_M_M { font-size: 16px; }
    .text-L_L_L { font-size: 20px; }
    .text-X_X_X { font-size: 24px; }

    /* ルビの大きさクラス (rt に付与する) */
    rt.ruby-XS_S_S { font-size: 0.30em; }
    rt.ruby-S_S_S  { font-size: 0.40em; }
    rt.ruby-M_M_M  { font-size: 0.50em; }
    rt.ruby-L_L_L  { font-size: 0.60em; }
    rt.ruby-XL_L_L { font-size: 0.70em; }
    rt.ruby-XXL_L_L{ font-size: 0.80em; }

    /* -------------------------------------------
       1) <ruby> は inline-block + position: relative 
          → 自身をルビ配置の基準にする
       ------------------------------------------- */
    ruby {
      display: inline-block;
      position: relative;  /* ここを基準に rt を absolute 配置 */
      line-height: 1;      /* 行の高さをベーステキストだけに合わせる */
      white-space: nowrap; /* 改行防止（折り返しが起きるとズレるため推奨） */
      margin: 0 0.2em;     /* 文字の左右余白はお好みで */
      vertical-align: middle; 
    }

    /* -------------------------------------------
       2) <rt> は absolute で上に重ねる
          top, left, transform 等で位置を微調整
       ------------------------------------------- */
    rt {
      position: absolute;
      left: 50%;                 /* 親rubyの中央を基準に */
      transform: translateX(-50%); /* 中央揃え */
      color: blue;
      line-height: 1;           /* ルビ自体の高さはコンパクトに */
    }

    /* デフォルトの位置調整 (全体) */
    rt {
      top: -0.7em; /* ルビをどれくらい上に配置するか(環境により微調整) */
    }

    /* ルビサイズごとの個別高さ調整例:
       ルビの大きさに応じて top を変えたい場合に併用 */
    rt.ruby-XS_S_S { top: -0.5em; }
    rt.ruby-S_S_S  { top: -0.6em; }
    rt.ruby-M_M_M  { top: -0.7em; }
    rt.ruby-L_L_L  { top: -0.8em; }
    rt.ruby-XL_L_L { top: -0.9em; }
    rt.ruby-XXL_L_L{ top: -1.0em; }

    /* -------------------------------------------------
       3) スマホなど画面幅が小さい時は別途調整が必要。
          例: ルビサイズを少し大きく、top をさらに上げる等
       ------------------------------------------------- */
    @media (max-width: 480px) {
      ruby {
        /* 行間を少し広げないとルビが隣の行に衝突しやすい */
        line-height: 1.2;
      }
      rt {
        /* ルビを少し大きく, さらに上へ移動 */
        font-size: 0.55em; /* 任意 */
        top: -0.8em;
      }
    }
  </style>
</head>
<body>
  <p class="text-M_M_M">
    <!-- 短文であれば折り返しリスクが少ないのでまだ安全 -->

    <!-- ルビ付き文字（例1）: ルビサイズ Small -->
    <ruby>
      fe
      <rt class="ruby-S_S_S">妖精</rt>
    </ruby>
    <!-- メインテキストが続く -->
    o 

    <!-- ルビ付き文字（例2）: ルビサイズ Medium -->
    <ruby>
      fe
      <rt class="ruby-M_M_M">妖精</rt>
    </ruby>
    a 

    <!-- ルビ付き文字（例3）: XXL -->
    <ruby>
      jar
      <rt class="ruby-XXL_L_L">年</rt>
    </ruby>
    e 

    <ruby>
      mi
      <rt class="ruby-XXL_L_L">私</rt>
    </ruby> 
    <ruby>
      vol
      <rt class="ruby-XS_S_S">意志</rt>
    </ruby>
    <ruby>
      as
      <rt class="ruby-XS_S_S">現在</rt>
    </ruby>

    <ruby>
      prov
      <rt class="ruby-M_M_M">(を)試す</rt>
    </ruby>
    i
    <ruby>
      skrib
      <rt class="ruby-L_L_L">(を)書く</rt>
    </ruby>
    i 
    <ruby>
      ĉiu
      <rt class="ruby-XS_S_S">各々</rt>
    </ruby>
    <ruby>
      tag
      <rt class="ruby-XXL_L_L">日</rt>
    </ruby>
    e
    <ruby>
      iom
      <rt class="ruby-XXL_L_L">多少</rt>
    </ruby>
    <ruby>
      post
      <rt class="ruby-S_S_S">後で</rt>
    </ruby>
    <ruby>
      iom
      <rt class="ruby-XXL_L_L">多少</rt>
    </ruby>
  </p>
</body>
</html>
